---
title: 使用审计日志追踪用户操作
slug: /getting-started/audit-logging
---

API7 企业版提供审计日志功能，用于监控和记录用户在 API7 企业版上的各项操作活动，其中涵盖用户登录控制台以及调用 API / ADC 时进行的所有操作。API7 企业版使用 token 作为身份凭证，用于验证用户或应用程序的身份；而审计日志则会记录所有涉及 token 的身份认证和授权操作，与 token 机制相辅相成，为平台的安全性提供有力保障。

所有用户对 API 的调用操作都会生成相应的审计日志。具有审计日志查看和下载权限的用户，可以查看这些日志的详细信息，并将其导出为 JSON 或 CSV 格式，便于进一步分析。每条审计日志包含操作时间、操作者、事件类型、被操作的资源 ID 和名称、操作者的 IP 地址以及操作来源等信息。

为保护日志中的敏感信息，API7 企业版制定了严格的脱敏处理机制。同时，为满足用户的合规性需求，这些审计日志默认保留 180 天。通过审计日志功能，用户可以全面掌握 API7 企业版的使用情况，及时发现并应对可能的安全隐患，从而有效提高平台的安全性和合规性。

## 背景介绍

随着对 API 接口的调用和系统操作变得日益频繁，缺乏有效的监控和记录机制容易导致出现安全隐患和操作风险。许多行业都面临着合规性管理的要求，需要对关键操作进行详细记录和审计。

审计日志可以详细记录用户的各种操作行为，企业可以借此及时发现异常情况，也能帮助企业快速定位问题并采取相应的安全防护措施，有效降低安全风险。同时，企业对关键操作进行详细记录和审计，能为后续的合规性审计提供依据。

## 前提条件

1. [安装 API7 企业版](../getting-started/install-api7-ee.md)。

2. 准备一个 `super admin` 权限的账号，或者由 `super admin` 配置了查看/下载审计日志权限的账号。

## 案例 1 ：审计 30 天内创建服务的日志

1. 进入组织分类下的审计日志模块。

2. 可以通过在事件中选择 **Add Service**，操作者选择对应的用户，如运维人员 `Ops`，再点击 **搜索**。

3. 在顶部限定日期，选择 **30 天**，即可显示最近 30 天内 `Ops` 用户创建服务的所有日志记录。

4. 点击 **详情** 即可查看对应事件的操作日志。每一条日志记录中包含“时间”、“操作者”、“事件”、“资源 ID”、“资源名称”、“IP 地址”、“来源”这些信息。

5. 点击 **导出**，选择 **JSON** 或 **CSV** 格式，即可下载。

## 案例 2：审计 7 天内 `my-service` 服务的日志

1. 进入模板复制 `my-service` 服务的 ID：`fb2a549b-f5a8-46ee-b9c6-b0cc167ec5ae`。

2. 进入组织分类下的 **审计日志** 模块，粘贴复制的服务 ID 至 **资源 ID** 栏。

3. 操作者选择对应的用户，如 `Ops`，再点击 **搜索**。

4. 在顶部限定日期，选择 **7 天**，即可显示最近 7 天内 `Ops` 用户在 `my-service` 服务的所有日志记录。

5. 点击 **详情** 即可查看对应事件的操作日志。每一条日志记录中包含“时间”、“操作者”、“事件”、“资源 ID”、“资源名称”、“IP 地址”、“来源”这些信息。

6. 点击 **导出**，选择 **JSON** 或 **CSV** 格式，即可下载。

## 分析日志数据

除了基本的查询和筛选功能外，API7 企业版还支持将审计日志导出为 JSON 或 CSV 格式的文件。推荐把这些数据导入专门的分析平台，如 ELK Stack（Elasticsearch、Logstash、Kibana）进行进一步的分析和处理，如使用数据分析工具进行数据挖掘和可视化展示等。

## 结论

API7 企业版的日志审计功能通过提供全面的日志记录和实时分析能力，帮助管理员快速定位问题根源并采取相应的修复措施。此外，该功能还为企业的信息安全和合规性管理提供了有力支持。
